# **函数**

## **数值函数**

|     函数      |                             功能                             |
| :-----------: | :----------------------------------------------------------: |
|    abs(x)     |                       返回 x 的绝对值                        |
|   mod(x,y)    |                   返回  X  除以  y 的余数                    |
|    ceil(x)    |                返回  大于  x 的最小 **整数**                 |
|   floor(x)    |                返回  小于  x 的最大 **整数**                 |
|    rand()     |                       返回0~1 的随机数                       |
|   round(x)    | 返回  **x** 进行四舍五入  < 其中 round(x) : **整数**    round(x,y): **保留到 y 位**  > |
| truncate(x,y) |          对数值  X 进行截取，  保留小数点后  y  位           |

#### 求绝对值函数

```shell
MariaDB [user]> select abs(5),abs(-5);
+--------+---------+
| abs(5) | abs(-5) |
+--------+---------+
|      5 |       5 |
+--------+---------+
```

#### 取余

```shell
MariaDB [user]> select mod(6,4),mod(6,0),mod(0,4);
+----------+----------+----------+
| mod(6,4) | mod(6,0) | mod(0,4) |
+----------+----------+----------+
|        2 |     NULL |        0 |
+----------+----------+----------+
1 row in set (0.00 sec)
```

#### 获取整数

###### ceil()   返回  大于  x 的最小 **整数** 

```shell
MariaDB [user]> select ceil(2.45),ceil(-9.34);
+------------+-------------+
| ceil(2.45) | ceil(-9.34) |
+------------+-------------+
|          3 |          -9 |
+------------+-------------+
1 row in set (0.00 sec)
```

###### floor() 返回  小于  x 的最大 **整数** 

```shell
MariaDB [user]> select floor(2.5),floor(-2.4);
+------------+-------------+
| floor(2.5) | floor(-2.4) |
+------------+-------------+
|          2 |          -3 |
+------------+-------------+
```

#### 获取随机数的函数

```shell
MariaDB [user]> select rand();
+--------------------+
| rand()             |
+--------------------+
| 0.4592823427722625 |
+--------------------+
```

#### 四舍五入函数

```shell
MariaDB [user]> select round(100.223),round(100.6); 
+----------------+--------------+
| round(100.223) | round(100.6) |
+----------------+--------------+
|            100 |          101 |
+----------------+--------------+
```

#### 截取小数函数

---

格式    truncate(数，取小数后几位)

```shell
MariaDB [user]> select truncate(1.32,1),truncate(1.1234,2);
+------------------+--------------------+
| truncate(1.32,1) | truncate(1.1234,2) |
+------------------+--------------------+
|              1.3 |               1.12 |
+------------------+--------------------+
```

## **字符串函数**

#### 返回字符的长度

```shell
MariaDB [user]> select length(''),length('abcd'),length('时间');
+------------+----------------+------------------+
| length('') | length('abcd') | length('时间')   |
+------------+----------------+------------------+
|          0 |              4 |                6 |
+------------+----------------+------------------+
```

> 结论： ' ' 不算位， 每个汉字算  3 个字节



#### 返回字符的个数

```shell
MariaDB [user]> select char_length('ABCD'),char_length('数据库');
+---------------------+--------------------------+
| char_length('ABCD') | char_length('数据库')    |
+---------------------+--------------------------+
|                   4 |                        3 |
+---------------------+--------------------------+
```

#### 合并字符串

```shell
MariaDB [user]> select concat('你是','好人','么');     
+---------------------------------+
| concat('你是','好人','么')      |
+---------------------------------+
| 你是好人么                      |
+---------------------------------+
```

#### 增加分隔符

```shell

MariaDB [user]> select concat_ws('？','书','本','？');
+------------------------------------+
| concat_ws('？','书','本','？')     |
+------------------------------------+
| 书？本？？                         |
+------------------------------------+
```

#### 替换字符

```mariadb
MariaDB [user]> select insert('北京欢迎你',1,2,'你我');
+----------------------------------------+
| insert('北京欢迎你',1,2,'你我')        |
+----------------------------------------+
| 你我欢迎你                             |
+----------------------------------------+
```

> 结论：  **1，2** 表示： 第 1 个开始，到第二个结束

#### 字母大小写转换函数

```mariadb
MariaDB [user]> select lower('aBcD'),upper('aBcD');
+---------------+---------------+
| lower('aBcD') | upper('aBcD') |
+---------------+---------------+
| abcd          | ABCD          |
+---------------+---------------+
```

> **注：**  lower（ ）将字母转换为小写
>
> ​          upper （ ）将字母转换为大写

#### 获取指定长度字符

```mariadb
MariaDB [user]> select left('beijinglvyougonglue',7),right('beijinglvyougonglue',6);
+-------------------------------+--------------------------------+
| left('beijinglvyougonglue',7) | right('beijinglvyougonglue',6) |
+-------------------------------+--------------------------------+
| beijing                       | onglue                         |
+-------------------------------+--------------------------------+
```

> 总结 ： left （）  取左边的    right（） 取右边的

## **时间函数**





|    类型     |          用途          |
| :---------: | :--------------------: |
| curtime（） |    获取当前系统时间    |
|  curdate()  |    获取当前系统日期    |
|   now ()    | 获取当前系统日期和时间 |
|   year()    |         获取年         |
|  month(）   |         获取月         |
|    day()    |         获取日         |
|  date（）   |        获取日期        |
|  time（）   |        获取时间        |



## 用法

```shell
mysql> select curtime();                     //时间
+-----------+
| curtime() |
+-----------+
| 22:03:25  |
+-----------+


mysql> select curdate();                  //日期
+------------+
| curdate()  |
+------------+
| 2021-07-10 |
+------------+

 
mysql> select now();                        //日期和时间
+---------------------+
| now()               |
+---------------------+
| 2021-07-10 22:04:52 |
+---------------------+
1 row in set (0.00 sec)
```

```shell
mysql> select year( now() );
+---------------+
| year( now() ) |
+---------------+
|          2021 |
+---------------+

```

#### 获取当前~*日期*~的函数

```mariadb
MariaDB [user]> select curdate();
+------------+
| curdate()  |
+------------+
| 2021-11-13 |
```

#### 获取当前时间的函数

```mariadb
MariaDB [user]> select curtime();
+-----------+
| curtime() |
+-----------+
| 08:42:01  |
+-----------+
```

#### 获取当前日期和时间的函数

```mariadb
MariaDB [user]> select now();
+---------------------+
| now()               |
+---------------------+
| 2021-11-13 08:43:12 |
+---------------------+
```

#### 获取年，月，星期，日，时 ，分，秒

```mariadb
MariaDB [user]> select year(now());   # 年  < 当前年份 >
+-------------+
| year(now()) |
+-------------+
|        2021 |
+-------------+


MariaDB [user]> select year('09-11-22');    # 指定年份
+------------------+
| year('09-11-22') |
+------------------+
|             2009 |
+------------------+


MariaDB [user]> select month(now());     # 当前月份
+--------------+
| month(now()) |
+--------------+
|           11 |
+--------------+


MariaDB [user]> select month(now()),week(now());     # 当前月份  与 周数
+--------------+-------------+
| month(now()) | week(now()) |
+--------------+-------------+
|           11 |          45 |
+--------------+-------------+


MariaDB [user]> select hour('15:8:00'),minute('15:8:00'),second('15:8:00');    #  小时    分钟    秒
+-----------------+-------------------+-------------------+
| hour('15:8:00') | minute('15:8:00') | second('15:8:00') |
+-----------------+-------------------+-------------------+
|              15 |                 8 |                 0 |
+-----------------+-------------------+-------------------+
```

## **例题**

```shell
mysql> create table aa;
ERROR 1113 (42000): A table must have at least 1 column
mysql> create table aa(
    -> 时间 int(20),
    -> 月份 int(20),
    -> 地点 char(30),
    -> name char(20)
    -> )default charset=utf8;
Query OK, 0 rows affected (0.08 sec)
 
mysql> desc aa;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |
+--------+----------+------+-----+---------+-------+
| 时间   | int(20)  | YES  |     | NULL    |       |
| 月份   | int(20)  | YES  |     | NULL    |       |
| 地点   | char(30) | YES  |     | NULL    |       |
| name   | char(20) | YES  |     | NULL    |       |
+--------+----------+------+-----+---------+-------+
4 rows in set (0.01 sec)

mysql> insert into aa values(time(now()),month(now()),"重庆","Tom");
Query OK, 1 row affected (0.01 sec)

mysql> select *from aa;
+--------+--------+--------+------+
| 时间   | 月份   | 地点   | name |
+--------+--------+--------+------+
| 222155 |      7 | 重庆   | Tom  |
+--------+--------+--------+------+
1 row in set (0.01 sec)
```



#### 优化

```shell
mysql> create table bb( 
时间 time,        
月份 year, 
地点 char(30), 
name char(20) 
)default charset=utf8;  
Query OK, 0 rows affected (0.03 sec)

mysql> desc bb;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |
+--------+----------+------+-----+---------+-------+
| 时间   | time     | YES  |     | NULL    |       |
| 月份   | year(4)  | YES  |     | NULL    |       |
| 地点   | char(30) | YES  |     | NULL    |       |
| name   | char(20) | YES  |     | NULL    |       |
+--------+----------+------+-----+---------+-------+
4 rows in set (0.03 sec)

mysql> insert into bb values(time(now()),year(now()),"重庆","Tom");
Query OK, 1 row affected (0.01 sec)

mysql> select *from bb;
+----------+--------+--------+------+
| 时间     | 月份   | 地点   | name |
+----------+--------+--------+------+
| 22:36:47 |   2021 | 重庆   | Tom  |
+----------+--------+--------+------+
1 row in set (0.00 sec)
```



## **条件判断函数**

|      函数      |                      功能                      |
| :------------: | :--------------------------------------------: |
| if(expr,v1,v2) |    如果expr 为真，则返回  v1,  否则返回  v2    |
| ifnull(v1,v2)  | 如果 v1 不为  null  ， 返回  v1 , 否则返回  v2 |

#### 例：

```mariadb
MariaDB [user]> select if(2=1,14,15);
+---------------+
| if(2=1,14,15) |
+---------------+
|            15 |
+---------------+
```











